<!-- Dit is een commentaar -->

<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Glunder ‚Äî Countdown & Spellen</title>

<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#081915;
  --panel:#0e362a;
  --gold:#d8c79e;
  --beige:#efe6cf;
  --deepgreen:#083521;
  --accent:#ffd766;
}
*{box-sizing:border-box}
body{
  margin:0; font-family:'Cormorant Garamond', serif;
  background:linear-gradient(180deg,#061615,#0a2218);
  color:var(--beige); -webkit-font-smoothing:antialiased;
}
.container{max-width:1100px;margin:18px auto;padding:18px;display:grid;grid-template-columns:1fr 420px;gap:18px;align-items:start;}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.03));padding:14px;border-radius:12px;border:1px solid rgba(255,215,130,0.04);box-shadow:0 12px 36px rgba(0,0,0,0.55);}
.header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.h1{font-size:28px;font-weight:700}
.small{font-size:13px;color:rgba(255,245,220,0.9)}

/* Countdown / moon */
.countdown{display:flex;flex-direction:column;align-items:center;gap:12px;min-height:320px;justify-content:center}
.moon{
  width:260px;height:260px;border-radius:50%;display:flex;align-items:center;justify-content:center;
  background-image:url('supermoon.png'); background-size:cover; background-position:center;
  border:3px solid rgba(255,215,130,0.06);
  box-shadow:0 16px 40px rgba(0,0,0,0.7), inset 0 8px 28px rgba(255,245,190,0.02);
  position:relative;
}
.moon-number{font-size:clamp(40px,7vw,88px);color:var(--deepgreen);font-weight:700;text-shadow:0 0 12px rgba(255,240,180,0.14);}
.moon-label{position:absolute;bottom:10px;font-size:14px;color:rgba(255,250,230,0.9)}
.countdown-note{font-size:16px;color:rgba(255,245,220,0.9)}

/* special final text - hidden until target day */
.special-final{display:none;margin-top:8px;font-style:italic;font-weight:700;color:var(--accent);font-size:22px;text-align:center;opacity:0;transition:opacity .6s ease}
.special-final.show{display:block;opacity:1}

/* Horoscope */
.horo {display:flex;gap:12px;align-items:center}
.sign-badge{width:78px;height:78px;border-radius:10px;background:linear-gradient(180deg,#f1f6ea,#eef8e8);color:#12321f;display:flex;align-items:center;justify-content:center;font-weight:700;border:1px solid rgba(40,60,40,0.06)}
.horo-text{color:#0f3b28}

/* Memory */
.memory-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;width:100%;max-width:360px;margin:0 auto}
.memory-card{width:78px;height:78px;perspective:900px}
.memory-inner{position:relative;width:100%;height:100%;transform-style:preserve-3d;transition:transform .55s cubic-bezier(.2,.9,.3,1);border-radius:10px}
.memory-front,.memory-back{position:absolute;inset:0;border-radius:10px;backface-visibility:hidden;display:flex;align-items:center;justify-content:center;overflow:hidden}
.memory-front img{width:100%;height:100%;object-fit:cover}
.memory-back{background:linear-gradient(135deg,#cbb78f,#efe6cf);transform:rotateY(180deg);box-shadow:inset 0 -8px 18px rgba(0,0,0,0.05)}
.memory-card.flipped .memory-inner{transform:rotateY(180deg)}
.memory-card.matched .memory-inner{opacity:0.5;transform:scale(.98);pointer-events:none}

/* Puzzle 3x3 */
.puzzle-board{width:320px;height:320px;display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin:0 auto;background:transparent}
.puzzle-tile{border-radius:8px;background-size:320px 320px;cursor:pointer;box-shadow:inset 0 -6px 12px rgba(0,0,0,0.08);transition:transform .18s ease}
.puzzle-empty{background:linear-gradient(180deg,#071812,#062116);cursor:default;box-shadow:none}

/* Sudoku 6x6 */
.sudoku-wrap{width:100%;max-width:420px;margin:0 auto}
.sudoku-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:8px;padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:10px;position:relative}
.sudoku-cell{background:#fff;border-radius:8px;padding:0;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px;color:#122d20;box-shadow:0 6px 12px rgba(0,0,0,0.06)}
.sudoku-cell input{width:100%;height:48px;border:0;font-size:18px;text-align:center;background:transparent;outline:none}
.sudoku-cell.prefilled{background:#f3f6ed;color:#122d20}
.sudoku-grid::before,.sudoku-grid::after{content:'';position:absolute;background:rgba(255,215,130,0.22)}
.sudoku-grid::before{width:4px;height:100%;left:50%;top:0;transform:translateX(-2px);border-radius:2px}
.sudoku-grid::after{height:4px;width:100%;top:50%;left:0;transform:translateY(-2px);border-radius:2px}

/* solved visual */
.solved-glow{box-shadow:0 0 40px rgba(255,215,120,0.28) !important;transform:scale(1.01);transition:transform .3s ease}

/* small utilities */
.controls{display:flex;gap:8px;justify-content:center;margin-top:8px}
.btn{background:var(--accent);color:#2b2416;border:0;padding:8px 12px;border-radius:8px;font-weight:700;cursor:pointer}

/* confetti */
.confetti{position:fixed;left:0;top:0;width:100%;height:100%;pointer-events:none;z-index:9999;display:none;overflow:hidden}

/* responsive */
@media(max-width:980px){
  .container{grid-template-columns:1fr;padding:12px}
  .puzzle-board{width:260px;height:260px;background-size:260px 260px}
  .moon{width:190px;height:190px;background-size:cover}
  .memory-grid{max-width:260px;gap:8px}
}
</style>
</head>
<body>

<div class="container">

  <!-- LEFT column: countdown + horo -->
  <div class="card">
    <div class="header"><div class="h1">Countdown</div><div class="small">Amsterdam ‚Äî 28 nov 19:30</div></div>

    <div class="countdown" aria-live="polite">
      <div class="moon" id="moonEl" role="img" aria-label="Maan met aantal nachtjes">
        <div class="moon-number" id="moonNumber">‚Ä¶</div>
        <div class="moon-label" id="moonLabel">nachtjes</div>
      </div>

      <div class="countdown-note">Nog even wachten lieve Glunder üåô</div>

      <div id="specialFinal" class="special-final" aria-hidden="true">
        Vandaag is het eindelijk zover!<br>
        <span style="font-size:16px;">Vandaag weer samen ‚Ä¢ Vandaag dichtbij, Glunder üßúüèª‚Äç‚ôÄÔ∏è‚ú®</span>
      </div>
    </div>
  </div>

  <!-- RIGHT column: games -->
  <div style="display:flex;flex-direction:column;gap:14px">
    <!-- HOROSCOPE CARD -->
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:700">Dagelijkse Horoscoop</div><div style="opacity:0.14">‚ú¶</div></div>
      <div style="margin-top:12px" class="horo">
        <div class="sign-badge" id="signBadge"><div id="signSymbol" style="font-size:22px">‚ôà</div></div>
        <div style="flex:1">
          <div class="horo-text"><h3 id="signName" style="margin:0">Ram</h3><p id="signQuote" style="margin:8px 0 0 0">Je quote verschijnt hier‚Ä¶</p></div>
          <div class="controls">
            <button class="btn" id="prevSign">‚Üê Vorige</button>
            <button class="btn" id="nextSign">Volgende ‚Üí</button>
            <button class="btn" id="randomSign">Willekeurig</button>
          </div>
        </div>
      </div>
    </div>

    <!-- MEMORY -->
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:700">Glunder Memory</div><div style="opacity:0.12">‚ú®</div></div>
      <div style="margin-top:12px">
        <div id="memoryGrid" class="memory-grid" aria-live="polite"></div>
        <div style="display:flex;gap:8px;justify-content:center;margin-top:10px">
          <button class="btn" id="shuffleMemoryBtn">Schud / Nieuw</button>
        </div>
        <div id="memoryMessage" style="text-align:center;margin-top:8px;color:var(--beige);font-weight:700;display:none">üéâ Memory voltooid! Nieuwe ronde‚Ä¶</div>
      </div>
    </div>

    <!-- PUZZLE -->
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:700">Glunder Schuifpuzzel</div><div style="opacity:0.12">ü™Ñ</div></div>
      <div style="margin-top:12px">
        <div id="puzzleBoard" class="puzzle-board" aria-live="polite"></div>
        <div class="controls">
          <button class="btn" id="shufflePuzzle">Schud</button>
          <button class="btn" id="nextVariant">Volgende afbeelding</button>
        </div>
        <div id="puzzleMessage" style="text-align:center;margin-top:8px;color:var(--beige);font-weight:700;display:none">‚ú® Puzzel compleet! Volgende‚Ä¶</div>
      </div>
    </div>

    <!-- SUDOKU -->
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center"><div style="font-weight:700">Glunder Sudoku</div><div style="opacity:0.12">üî¢</div></div>
      <div style="margin-top:12px">
        <div class="sudoku-wrap"><div id="sudokuGrid" class="sudoku-grid" aria-live="polite"></div></div>
        <div class="controls" style="margin-top:10px">
          <button class="btn" id="checkSudokuBtn">Controleer</button>
          <button class="btn" id="nextSudokuBtn">Volgende sudoku</button>
          <button class="btn" id="resetSudokuBtn">Reset</button>
        </div>
        <div id="sudokuMessage" style="text-align:center;margin-top:8px;color:var(--beige);font-weight:700;display:none">‚úÖ Sudoku voltooid ‚Äî nieuwe puzzel geladen</div>
      </div>
    </div>
  </div>

</div>

<div class="confetti" id="confetti"></div>

<script>
/* ===================== COUNTDOWN ===================== */
const target = new Date('2025-11-28T19:30:00+01:00');

function updateCountdown(){
  const now = new Date();
  const todayMidnight = new Date(now.getFullYear(), now.getMonth(), now.getDate());
  const targetMidnight = new Date(target.getFullYear(), target.getMonth(), target.getDate());
  let nights = Math.ceil((targetMidnight - todayMidnight) / (1000*60*60*24));
  if(nights < 0) nights = 0;
  document.getElementById('moonNumber').textContent = nights;
  document.getElementById('moonLabel').textContent = nights===1 ? 'nacht' : 'nachtjes';

  const isTargetDay = now.getFullYear()===target.getFullYear() && now.getMonth()===target.getMonth() && now.getDate()===target.getDate();
  const special = document.getElementById('specialFinal');
  if(isTargetDay){
    special.classList.add('show'); special.setAttribute('aria-hidden','false');
  } else {
    special.classList.remove('show'); special.setAttribute('aria-hidden','true');
  }
}
updateCountdown();
setInterval(updateCountdown, 20000);

/* ===================== HOROSCOPE ===================== */
const horoscopeData = [
  {sign:"Ram", symbol:"‚ôà", quotes:["Je hart klopt sneller van verwachting.","Je durft ‚Äî en dat maakt het spannend mooi.","Een kleine daad zet een avond in beweging.","Je glimlach nodigt iemand dichterbij.","Vandaag straal je met zachte overgave.","Laat je energie zachtjes de kamer vullen.","Iemand merkt je warmte op zonder woorden.","Durf te glunderen ‚Äî het past je goed."]},
  {sign:"Stier", symbol:"‚ôâ", quotes:["Comfort en smaak maken dit moment kostbaar.","Een rustige aanwezigheid geeft diepe rust.","Geniet van de tastbare details om je heen.","Vandaag voelt nabijheid als een cadeau.","Subtiele aanraking zegt meer dan menig woord.","Laat je zintuigen rustig de weg wijzen.","Een bekend lied roept zachte herinnering op.","Eenvoudige luxe kleedt jouw momenten."]},
  {sign:"Tweelingen", symbol:"‚ôä", quotes:["Je praatjes openen kleine werelden van plezier.","Humor maakt een kamer lichter en zachter.","Een nieuwsgierige vraag start een hartelijk gesprek.","Je woorden dansen licht in de lucht.","Verrassing in taal brengt een glimlach.","Laat je geest speels de avond kleuren.","Korte gesprekken kunnen diepe connecties brengen.","Je charme werkt als een zachte uitnodiging."]},
  {sign:"Kreeft", symbol:"‚ôã", quotes:["Zachtheid en aandacht scheppen een thuisgevoel.","Een warme blik zegt wat woorden niet hoeven.","Koester kleine momenten van echte verbinding.","Je zorgzame aard opent stil gedeelde ruimte.","Herinneringen vinden vanavond een zachte plek.","Je aanwezigheid voelt als een geruststellende omhelzing.","Laat tederheid de avond verlichten.","Intimiteit groeit in kleine, stille gebaren."]},
  {sign:"Leeuw", symbol:"‚ôå", quotes:["Je helderheid trekt bewondering zonder moeite.","Vandaag zal je lach de kamer doen oplichten.","Stralend en zacht ‚Äî je bent onmiskenbaar aanwezig.","Een compliment weerkaatst jouw warme energie.","Je durft te schitteren op een elegante manier.","Grootsheid met tederheid is jouw stijl vandaag.","Laat je hart spreken ‚Äî het klinkt als muziek.","Een klein applausje kan onverwacht veel betekenen."]},
  {sign:"Maagd", symbol:"‚ôç", quotes:["Oog voor detail maakt kleine magie zichtbaar.","Je zorgvuldigheid tovert orde tot rust.","Subtiele perfecties geven de avond inhoud.","Je praktische aanraking voelt als blijk van zorg.","Nette aandacht cre√´ert warme herinnering.","Stilheid met zorg kan veel liefde zeggen.","Je precisie vertaalt zich in elegante momenten.","Een kleine handeling oogst grote waardering."]},
  {sign:"Weegschaal", symbol:"‚ôé", quotes:["Schoonheid en evenwicht dansen langs je heen.","Een charmante opmerking opent zachte ogen.","Balans brengt ruimte voor oprechte gesprekken.","Je elegantie nodigt mensen uit dichtbij te komen.","Rust en stijl maken vanavond memorabel.","Zachte humor weeft fijne herinneringen in de tijd.","Jouw eenvoud ademt een bijzondere allure.","Harmonie kleurt de avond in goudtinten."]},
  {sign:"Schorpioen", symbol:"‚ôè", quotes:["Intensiteit en zachtheid vinden elkaar bij jou.","Een scherpe blik kan heel veel zeggen vandaag.","Laat je diepgang zachtjes naar buiten stromen.","Intieme aandacht schept onvergetelijke momenten.","Een geheim gebaar heeft grote betekenis vanavond.","Diepe gevoelens vertalen zich in warme daden.","Laat je hart spreken ‚Äî in stilte of in woord.","Passie met tederheid maakt alles eerbiedig."]},
  {sign:"Boogschutter", symbol:"‚ôê", quotes:["Avontuurlijke vonken maken de avond licht.","Een onbevangen lach opent onverwachte deuren.","Nieuwsgierigheid leidt tot warme verrassingen.","Speelsheid nodigt anderen uit te delen.","Durf te stappen; mooie herinneringen wachten.","Recht door zee met een glimlach wint harten.","Laat enthousiasme zacht de ruimte vullen.","Een lichte grap breekt het ijs in goud."]},
  {sign:"Steenbok", symbol:"‚ôë", quotes:["Stabiel en attent ‚Äî jouw houding raakt anderen.","Doorzettingsvermogen krijgt een zachte glans vanavond.","Doordachte woorden geven houvast en nabijheid.","Je inzet cre√´ert waardevolle momenten.","Een rustige daad blijkt groter dan verwacht.","Consistentie voelt als een warm anker voor anderen.","Je vastberadenheid toont zich als zorg en stijl.","Met bedachtzaamheid bouw je intieme ruimte."]},
  {sign:"Waterman", symbol:"‚ôí", quotes:["Je verrassende blik cre√´ert nieuwe mogelijkheden.","Vernieuwend en vriendelijk ‚Äî een aanstekelijke mix.","Durf uniek te zijn; anderen volgen je graag.","Een origineel idee kan het gesprek verrijken.","Jouw visie nodigt uit tot open gesprekken.","Creatieve vonken kleuren de avond met plezier.","Anders zijn voelt vandaag als een zachte kracht.","Vreemde wendingen leiden soms tot warme momenten."]},
  {sign:"Vissen", symbol:"‚ôì", quotes:["Zacht en dromerig ‚Äî je brengt rust in het nu.","Een intu√Øtieve beweging verbindt twee zielen.","Dromen en realiteit vinden vanavond elkaar.","Laat je verbeelding leiden naar warme herinneringen.","Een kleine fantasie wordt tastbare zachtheid.","Je empathie maakt nabijheid veilig en rijk.","Mildheid en diepte vormen een stille belofte.","Eenvoudige dromen worden vanavond kostbaar."]}
];

let signIndex=0;
function showSign(i){
  signIndex=(i+horoscopeData.length)%horoscopeData.length;
  const obj = horoscopeData[signIndex];
  const now = new Date();
  const daySeed = now.getFullYear()*10000 + (now.getMonth()+1)*100 + now.getDate();
  const quoteIdx = (daySeed + signIndex) % obj.quotes.length;
  document.getElementById('signSymbol').textContent = obj.symbol;
  document.getElementById('signName').textContent = obj.sign;
  document.getElementById('signQuote').textContent = obj.quotes[quoteIdx];
}
document.getElementById('nextSign').addEventListener('click', ()=> showSign(signIndex+1));
document.getElementById('prevSign').addEventListener('click', ()=> showSign(signIndex-1));
document.getElementById('randomSign').addEventListener('click', ()=> showSign(Math.floor(Math.random()*horoscopeData.length)));
showSign(0);

/* ===================== CONFETTI HELPER ===================== */
function showConfetti(){
  const container = document.getElementById('confetti');
  container.innerHTML=''; container.style.display='block';
  const colors=['#ffd766','#e6b46a','#fff6d9','#d4a64b'];
  for(let i=0;i<48;i++){
    const el=document.createElement('div');
    el.style.position='absolute'; el.style.width=(6+Math.random()*10)+'px'; el.style.height=el.style.width;
    el.style.left=(20+Math.random()*60)+'%'; el.style.top=(20+Math.random()*60)+'%';
    el.style.background=colors[Math.floor(Math.random()*colors.length)]; el.style.opacity=0.95;
    el.style.transform=`translate(-50%,-50%) rotate(${Math.random()*360}deg)`; el.style.borderRadius='2px';
    container.appendChild(el);
    const dx=(Math.random()-0.5)*1200; const dy = -600 - Math.random()*900; const rot=(Math.random()-0.5)*720;
    el.animate([{transform:el.style.transform+' translate(0px,0px)', opacity:1},{transform:el.style.transform+` translate(${dx}px,${dy}px) rotate(${rot}deg)`, opacity:0}],{duration:1500+Math.random()*900,easing:'cubic-bezier(.15,.7,.4,1)'});
  }
  setTimeout(()=>{ container.style.display='none'; container.innerHTML=''; },2400);
}

/* ===================== MEMORY ===================== */
/*
Images must be in same folder:
- memory_moon.png
- memory_sun.png
- memory_saturn_png.jpg
- memory_venus.png
*/
const memoryImgs = [
  {id:'moon', src:'memory_moon.png'},
  {id:'sun', src:'memory_sun.png'},
  {id:'saturn', src:'memory_saturn_png.jpg'},
  {id:'venus', src:'memory_venus.png'}
];

let memDeck = [];
let memFirst=null, memSecond=null, memLock=false, memMatches=0;
const memoryGrid = document.getElementById('memoryGrid');
const memoryMsg = document.getElementById('memoryMessage');

function buildMemory(){
  memDeck = [...memoryImgs, ...memoryImgs].map((x,i)=>({...x, uid:i+'-'+x.id})).sort(()=>Math.random()-0.5);
  renderMemory();
}

function renderMemory(){
  memoryGrid.innerHTML='';
  memDeck.forEach(card=>{
    const el = document.createElement('div'); el.className='memory-card'; el.dataset.id=card.id; el.dataset.uid=card.uid;
    const inner = document.createElement('div'); inner.className='memory-inner';
    const front = document.createElement('div'); front.className='memory-front'; const img=document.createElement('img'); img.src=card.src; img.alt=card.id; front.appendChild(img);
    const back = document.createElement('div'); back.className='memory-back';
    inner.appendChild(front); inner.appendChild(back);
    el.appendChild(inner);
    el.addEventListener('click', ()=> flipMemory(el));
    memoryGrid.appendChild(el);
  });
  memFirst=null; memSecond=null; memLock=false; memMatches=0; memoryMsg.style.display='none';
}

function flipMemory(el){
  if(memLock || el.classList.contains('matched') || el===memFirst) return;
  el.classList.add('flipped');
  if(!memFirst){ memFirst = el; return; }
  memSecond = el; memLock=true;
  if(memFirst.dataset.id === memSecond.dataset.id){
    // match
    memFirst.classList.add('matched'); memSecond.classList.add('matched');
    memMatches++; memFirst=null; memSecond=null; memLock=false;
    if(memMatches === memoryImgs.length){
      memoryMsg.style.display='block';
      setTimeout(()=>{ memoryMsg.style.display='none'; showConfetti(); setTimeout(buildMemory,900); },1200);
    }
  } else {
    setTimeout(()=>{ memFirst.classList.remove('flipped'); memSecond.classList.remove('flipped'); memFirst=null; memSecond=null; memLock=false; },900);
  }
}
document.getElementById('shuffleMemoryBtn').addEventListener('click', buildMemory);
buildMemory();

/* ===================== SLIDING PUZZLE (3x3) with 4 variants =====================
 variants used (must be present in folder):
  - supermoon.png
  - memory_sun.png
  - memory_moon.png
  - memory_venus.png
================================================================== */
const puzzleImgs = ['supermoon.png','memory_sun.png','memory_moon.png','memory_venus.png'];
let puzzleVariant = 0;
const puzzleBoard = document.getElementById('puzzleBoard');
const puzzleMsg = document.getElementById('puzzleMessage');

let puzzleTiles = []; // values 0..8 or null
const N = 3; // 3x3

function isSolvable(arr){
  const flat = arr.filter(v=>v!==null);
  let inv=0;
  for(let i=0;i<flat.length;i++) for(let j=i+1;j<flat.length;j++) if(flat[i]>flat[j]) inv++;
  return inv%2===0;
}

function shufflePuzzle(){
  let arr = [...Array(N*N).keys()]; arr[arr.length-1]=null;
  do{
    for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; }
  } while(!isSolvable(arr) || arr.indexOf(null)!==arr.length-1);
  puzzleTiles=arr;
  renderPuzzle();
}

function renderPuzzle(){
  puzzleBoard.innerHTML=''; puzzleBoard.style.backgroundImage = `url('${puzzleImgs[puzzleVariant]}')`;
  puzzleBoard.style.backgroundSize = `${N*100}% ${N*100}%`;
  puzzleTiles.forEach((v,i)=>{
    const tile = document.createElement('div'); 
    if(v===null){ tile.className='puzzle-tile puzzle-empty'; }
    else {
      tile.className='puzzle-tile';
      const col = v % N; const row = Math.floor(v/N);
      tile.style.backgroundImage = `url('${puzzleImgs[puzzleVariant]}')`;
      tile.style.backgroundPosition = `${-col*100}% ${-row*100}%`;
      tile.style.backgroundSize = `${N*100}% ${N*100}%`;
    }
    tile.addEventListener('click', ()=> tryMove(i));
    puzzleBoard.appendChild(tile);
  });
}

function tryMove(i){
  const empty = puzzleTiles.indexOf(null);
  const r1 = Math.floor(i/N), c1=i%N;
  const r2 = Math.floor(empty/N), c2=empty%N;
  const dist = Math.abs(r1-r2)+Math.abs(c1-c2);
  if(dist===1){
    [puzzleTiles[i], puzzleTiles[empty]]=[puzzleTiles[empty], puzzleTiles[i]];
    renderPuzzle();
    if(checkPuzzleSolved()){ puzzleMsg.style.display='block'; puzzleBoard.classList.add('solved-glow'); showConfetti(); setTimeout(()=>{ puzzleMsg.style.display='none'; puzzleBoard.classList.remove('solved-glow'); puzzleVariant=(puzzleVariant+1)%puzzleImgs.length; shufflePuzzle(); },1200); }
  }
}
function checkPuzzleSolved(){ for(let i=0;i<puzzleTiles.length-1;i++) if(puzzleTiles[i]!==i) return false; return true; }

document.getElementById('shufflePuzzle').addEventListener('click', shufflePuzzle);
document.getElementById('nextVariant').addEventListener('click', ()=>{ puzzleVariant=(puzzleVariant+1)%puzzleImgs.length; shufflePuzzle(); });
shufflePuzzle();

/* ===================== SUDOKU (3 variants) ===================== */
/*
We store full solutions and create puzzles by hiding some cells.
When user fills all cells, auto-validate; if correct -> solved effect and auto-switch to next puzzle.
*/
const sudokuSolutions = [
  [
    [1,2,3,4,5,6],
    [4,5,6,1,2,3],
    [2,3,1,5,6,4],
    [5,6,4,2,3,1],
    [3,1,2,6,4,5],
    [6,4,5,3,1,2]
  ],
  [
    [2,4,1,3,6,5],
    [3,6,5,2,4,1],
    [1,5,3,6,2,4],
    [4,2,6,1,5,3],
    [5,3,4,6,1,2],
    [6,1,2,5,3,4]
  ],
  [
    [3,1,6,5,4,2],
    [5,2,4,3,6,1],
    [1,6,2,4,5,3],
    [4,3,5,2,1,6],
    [6,4,1,3,2,5],
    [2,5,3,1,6,4]
  ]
];

let currentSudoku = 0;
const sudokuGrid = document.getElementById('sudokuGrid');
const sudokuMsg = document.getElementById('sudokuMessage');

function makePuzzle(solution, holes=12){
  const puzzle = solution.map(r=>r.slice());
  let removed=0;
  const positions=[];
  for(let r=0;r<6;r++) for(let c=0;c<6;c++) positions.push([r,c]);
  positions.sort(()=>Math.random()-0.5);
  for(const [r,c] of positions){
    if(removed>=holes) break;
    puzzle[r][c]=0; removed++;
  }
  return puzzle;
}

function renderSudoku(){
  sudokuGrid.innerHTML='';
  const sol = sudokuSolutions[currentSudoku];
  const puzzle = makePuzzle(sol, 12);
  for(let r=0;r<6;r++){
    for(let c=0;c<6;c++){
      const wrapper = document.createElement('div'); wrapper.className='sudoku-cell';
      if(puzzle[r][c]!==0){
        wrapper.classList.add('prefilled'); wrapper.textContent = puzzle[r][c];
      } else {
        const inp = document.createElement('input'); inp.type='text'; inp.maxLength=1; inp.inputMode='numeric';
        inp.addEventListener('input', ()=>{ inp.value = inp.value.replace(/[^1-6]/g,'').slice(0,1); autoCheckSudoku(); });
        wrapper.appendChild(inp);
      }
      sudokuGrid.appendChild(wrapper);
    }
  }
}

function readSudoku(){
  const cells = sudokuGrid.querySelectorAll('.sudoku-cell'); const out=[];
  for(let r=0;r<6;r++){ const row=[]; for(let c=0;c<6;c++){ const idx=r*6+c; const cell=cells[idx]; if(cell.classList.contains('prefilled')) row.push(Number(cell.textContent)); else { const v=cell.querySelector('input').value; row.push(v?Number(v):0);} } out.push(row); } return out;
}

function isValidSudoku(grid){
  // row check
  for(let r=0;r<6;r++){
    const seen=new Set();
    for(let c=0;c<6;c++){ const v=grid[r][c]; if(v===0) continue; if(seen.has(v)) return false; seen.add(v);}
  }
  // col check
  for(let c=0;c<6;c++){
    const seen=new Set();
    for(let r=0;r<6;r++){ const v=grid[r][c]; if(v===0) continue; if(seen.has(v)) return false; seen.add(v);}
  }
  // boxes 2x3
  for(let br=0;br<3;br++) for(let bc=0;bc<2;bc++){
    const seen=new Set(); const sr=br*2, sc=bc*3;
    for(let r=0;r<2;r++) for(let c=0;c<3;c++){ const v = grid[sr+r][sc+c]; if(v===0) continue; if(seen.has(v)) return false; seen.add(v); }
  }
  return true;
}
function isComplete(grid){ for(let r=0;r<6;r++) for(let c=0;c<6;c++) if(grid[r][c]===0) return false; return true; }

function autoCheckSudoku(){
  const grid = readSudoku();
  if(!isValidSudoku(grid)) return;
  if(!isComplete(grid)) return;
  // solved!
  markSolved(sudokuGrid); showConfetti();
  sudokuMsg.style.display='block';
  setTimeout(()=>{ sudokuMsg.style.display='none'; currentSudoku=(currentSudoku+1)%sudokuSolutions.length; renderSudoku(); },1400);
}

document.getElementById('checkSudokuBtn').addEventListener('click', autoCheckSudoku);
document.getElementById('nextSudokuBtn').addEventListener('click', ()=>{ currentSudoku=(currentSudoku+1)%sudokuSolutions.length; renderSudoku(); });
document.getElementById('resetSudokuBtn').addEventListener('click', ()=> renderSudoku());

renderSudoku();

/* ===================== MARK SOLVED helper ===================== */
function markSolved(el){
  if(el.dataset.solved) return;
  el.dataset.solved='1';
  el.classList.add('solved-glow');
  setTimeout(()=> el.classList.remove('solved-glow'),2000);
}

/* utility: clear confetti & others on load */
window.addEventListener('load', ()=>{ document.getElementById('confetti').innerHTML=''; });

</script>
</body>
</html>
